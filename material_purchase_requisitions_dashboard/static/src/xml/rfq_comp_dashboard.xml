<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">

    <t t-name="material_purchase_requisitions_dashboard.RFQDashboard">
        <div class="o_dashboards" style="background-color: #c7cbce;">
            <t t-call="material_purchase_requisitions_dashboard.rfq_dashboard_header"/>
            <div class="o_rfq_dashboard">
                <t t-call="material_purchase_requisitions_dashboard.RFQCompareTable">
                    <t t-set="record_line_ids" t-value="state.purchase_ids.record_line_ids"/>
                    <t t-set="partner_ids" t-value="state.purchase_ids.partner_ids"/>
                    <t t-set="total" t-value="state.purchase_ids.total"/>
                    <t t-set="length" t-value="state.purchase_ids.length"/>
                    <t t-set="option" t-value="state.purchase_ids.option"/>
                    <t t-set="min_total_vendor" t-value="state.purchase_ids.min_total_vendor"/>
                    <t t-set="min_delivery_vendor" t-value="state.purchase_ids.min_delivery_vendor"/>
                    <t t-set="reqisition_name" t-value="state.purchase_ids.reqisition_name"/>
                </t>
            </div>
        </div>
    </t>

    <!-- HEADER TEMPLATE -->
    <t t-name="material_purchase_requisitions_dashboard.rfq_dashboard_header">
        <div>
            <div class="container">
                <div class="row">
                    <div class="col-sm-2" style="padding-right:0px;">
                        <div class="form-group">
                            <label style="font-weight:900;">RFQ Compare Type</label>
                            <select class="form-control" id="selection_type"
                                required="1" style="border-radius: 0px;"
                                t-on-change="onChangeSelectionType">
                                <option value="">Over All</option>
                                <option value="by_price">By Minimum Prize</option>
                                <option value="by_date">By Expected Delivery Date</option>
                            </select>
                        </div>
                    </div>
                    <div class="col-sm-2" style="padding-right:0px;">
                        <div class="form-group">
                            <label style="font-weight:900;">Project Filter</label>
                            <select class="form-control" id="project_filter"
                                style="border-radius: 0px;"
                                t-on-change="onChangeProjectFilter">
                                <option value="">All Projects</option>
                                <t t-foreach="(state.projects || [])" t-as="project" t-key="project.id">
                                    <option t-att-value="project.id" t-esc="project.name"/>
                                </t>
                            </select>
                        </div>
                    </div>
                    <div class="col-sm-4" style="padding-right:0px;">
                        <!-- Removed checkbox functionality -->
                    </div>
                </div>
            </div>
        </div>
    </t>

    <!-- MAIN TABLE TEMPLATE -->
    <t t-name="material_purchase_requisitions_dashboard.RFQCompareTable">

        <!-- Requisition Title -->
        <div class="row" style="padding-bottom: 13px;">
            <div style="width:50%;">
                <h3 style="text-align: right;font-size: 20px;">
                    RFQ Dashboard For:
                </h3>
            </div>
            <div style="width:50%;">
                <h3 style="text-align: left;font-size: 20px; margin-left: 5px;"
                    t-esc="reqisition_name"/>
            </div>
        </div>

        <div class="table_div" style="overflow-x:auto;">
            <table t-att-class="length gt 5 ? 'table pways-table-highlighted' : 'table pways-table'"
                   border="1">

                <!-- TABLE HEADER -->
                <thead class="thead-custom">
                    <tr>
                        <th class="headcol"
                            style="vertical-align: middle; width: 180px; text-align: center;
                                   position: sticky; top: 0; z-index: 1; background: darkslategrey;">
                            Product Detail
                        </th>

                        <t t-foreach="(partner_ids || [])" t-as="partner_id" t-key="partner_id['id'] or partner_id['name']">

                            <t t-if="partner_id['option'] == 'by_price'">
                                <th style="background: ghostwhite; text-align: center; color: black; min-width: 200px;">
                                    <span t-esc="partner_id['name']" style="font-size: 12px; font-weight: bold;"/>
                                    <br/>
                                    <small style="color: #ccb700;">RFQ: <span t-esc="partner_id['rfq_number']"/></small>
                                    <hr style="border-bottom:1px solid #e8f1f1;"/>
                                    <div class="row" style="display: flex;">
                                        <div style="width:43%; text-align: center;">PRICE</div>
                                        <div style="width:42%; text-align: center;">QTY</div>
                                        <div style="width:15%; text-align: left;"></div>
                                    </div>
                                </th>
                            </t>

                            <t t-elif="partner_id['option'] == 'by_date'">
                                <th style="background: ghostwhite; text-align: center; color: black; min-width: 200px;">
                                    <span t-esc="partner_id['name']" style="font-size: 12px; font-weight: bold;"/>
                                    <br/>
                                    <small style="color: #ccb700;">RFQ: <span t-esc="partner_id['rfq_number']"/></small>
                                    <hr style="border-bottom:1px solid #e8f1f1;"/>
                                    <div class="row" style="display: flex;">
                                        <div style="width:43%; text-align: center;">PRICE</div>
                                        <div style="width:42%; text-align: center;">QTY</div>
                                        <div style="width:15%; text-align: left;"></div>
                                    </div>
                                </th>
                            </t>

                            <t t-else="">
                                <th style="text-align: center; min-width: 200px;">
                                    <span t-esc="partner_id['name']" style="font-size: 12px; font-weight: bold;"/>
                                    <br/>
                                    <small style="color: #ccb700;">RFQ: <span t-esc="partner_id['rfq_number']"/></small>
                                    <hr style="border-bottom:1px solid #e8f1f1;"/>
                                    <div class="row" style="display: flex;">
                                        <div style="width:43%; text-align: center;">PRICE</div>
                                        <div style="width:42%; text-align: center;">QTY</div>
                                        <div style="width:15%; text-align: left;"></div>
                                    </div>
                                </th>
                            </t>

                        </t>
                    </tr>
                </thead>

                <!-- TABLE BODY -->
                <tbody>

                    <!-- PRODUCT LOOP -->
                    <t t-foreach="(record_line_ids || [])" t-as="record" t-key="record['id'] or record['product_name']">

                        <tr style="text-align: left;">

                            <!-- PRODUCT NAME COLUMN -->
                            <td class="headcol" style="vertical-align: middle;">
                                <div class="row">
                                    <div style="width:72%; text-align: left; margin-left: 18px;">
                                        <strong><span t-esc="record['product_name']"/></strong>
                                    </div>
                                </div>
                            </td>

                            <!-- PARTNER LINES -->
                            <t t-foreach="(record['record_lines'] || [])" t-as="lines"
                               t-key="lines['line_id'] or lines['partner_id']">

                                <t t-if="lines.line_id != 0">

                                    <t t-if="lines.option in ['by_price', 'by_date']">
                                        <td style="background: ghostwhite; color: black;">
                                            <span data-toggle="tooltip" t-att-title="lines.message">
                                                <div class="row" style="display: flex;">
                                                    <div style="width:43%; text-align: center;">
                                                        <t t-esc="lines.unit_price"/>
                                                    </div>
                                                    <div style="width:42%; text-align: center;">
                                                        <span t-esc="lines.qty"/>
                                                    </div>
                                                    <div style="width:15%; text-align: left;">
                                                        <button class="fa fa-trash remove_line"
                                                                t-att-data-id="lines.line_id"
                                                                t-on-click="onRemoveLine"
                                                                style="color: red;"/>
                                                    </div>
                                                </div>
                                            </span>
                                        </td>
                                    </t>

                                    <t t-else="">
                                        <td>
                                            <span data-toggle="tooltip" t-att-title="lines.message">
                                                <div class="row" style="display: flex;">
                                                    <div style="width:43%; text-align: center;">
                                                        <t t-esc="lines.unit_price"/>
                                                    </div>
                                                    <div style="width:42%; text-align: center;">
                                                        <span t-esc="lines.qty"/>
                                                    </div>
                                                    <div style="width:15%; text-align: left;">
                                                        <button class="fa fa-trash remove_line"
                                                            t-att-data-id="lines.line_id"
                                                            t-on-click="onRemoveLine"
                                                            style="color: red;"/>
                                                    </div>
                                                </div>
                                            </span>
                                        </td>
                                    </t>

                                </t>

                                <t t-else="">
                                    <td>
                                        <div class="row" style="display: flex;">
                                            <div style="width:43%;"></div>
                                            <div style="width:42%;"></div>
                                            <div style="width:15%;"></div>
                                        </div>
                                    </td>
                                </t>

                            </t>

                        </tr>

                    </t>

                    <!-- FOOTER TOTALS -->
                    <tr>
                        <td class="headcol" style="height: 68px;"></td>

                        <t t-foreach="(total || [])" t-as="t" t-key="t['id']">

                            <t t-if="t.option == 'by_price'">
                                <td class="table_footer" style="background: ghostwhite; color: black; height: 61px;">
                                    <div class="row" style="margin-left: -6px;">
                                        <div class="footer_left_row" style="float:left;">
                                            Total: <span t-esc="t.subtotal"/>
                                            <br/>
                                            State: <span t-esc="t.state"/>
                                        </div>
                                        <div class="footer_right_row" style="float:right;">
                                            Delivery Date: <span t-esc="t.delivery_date"/>
                                        </div>
                                    </div>

                                    <div style="text-align:center; margin-left:12px;">
                                        <t t-if="t.state == 'sent'">
                                            <input class="conform_order" type="button"
                                                value="Confirm" t-att-data-id="t.id"
                                                t-on-click="onConfirmOrder"/>
                                        </t>
                                        <t t-elif="t.state == 'cancel'">
                                            <span>Order Canceled...</span>
                                        </t>
                                        <t t-elif="t.state == 'draft'">
                                           <span>Order Draft...</span>
                                        </t>
                                        <t t-else="">
                                            <span>Order Confirmed...</span>
                                        </t>
                                    </div>
                                </td>
                            </t>

                            <t t-else="">
                                <td class="table_footer" style="height: 61px;">
                                    <div class="row" style="margin-left: -6px;">
                                        <div class="footer_left_row" style="float:left;">
                                            Total: <span t-esc="t.subtotal"/>
                                            <br/>
                                            State: <span t-esc="t.state"/>
                                        </div>
                                        <div class="footer_right_row" style="float:right;">
                                            Delivery Date: <span t-esc="t.delivery_date"/>
                                        </div>
                                    </div>

                                    <div style="text-align:center; margin-left:12px;">
                                        <t t-if="t.state == 'sent'">
                                            <input class="conform_order" type="button"
                                                value="Confirm" t-att-data-id="t.id"
                                                t-on-click="onConfirmOrder"/>
                                        </t>
                                        <t t-elif="t.state == 'cancel'">
                                            <span>Order Canceled...</span>
                                        </t>
                                        <t t-elif="t.state == 'draft'">
                                            <span>Order Draft...</span>
                                        </t>
                                        <t t-else="">
                                            <span>Order Confirmed...</span>
                                        </t>
                                    </div>
                                </td>
                            </t>

                        </t>
                    </tr>
                </tbody>
            </table>
        </div>

    </t>

</templates>
